#!/bin/bash

method="$1"; shift
url="$1"; shift
body="$*"
token=$(git gh-oauth)

test -z "$method" && echo "http method required" 1>&2 && exit 42
test -z "$(echo -e "GET\nPOST\nDELETE" | grep "^$method$")" && echo "invalid http method" 1>&2 && exit 43
test -z "$url" && echo "url required" 1>&2 && exit 42
test -z "$token" && echo "access token required." 1>&2 && exit 42

curl -sSX $method -H "Authorization: token $token" https://api.github.com$url -d "$body"
