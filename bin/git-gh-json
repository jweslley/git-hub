#!/bin/bash
# Better syntax to obtain JSON attributes using jshon.
#
# Example:
#
#    gh-json "number title user.login merged_at"
#
# is converted into:
#
#    jshon -a -e number -u -p -e title -u -p -e user -e login -u -p -p -e merged_at -u
#

attrs="$1"

cmd="cat - | tr '\n' ' ' | jshon -a "
for attr in $attrs ; do
  pstack=""
  for sub in $(echo $attr | sed 's/\./ /g') ; do
    cmd="$cmd -e $sub"
    pstack="$pstack -p"
  done
  cmd="$cmd -u $pstack"
done
cmd=$(echo $cmd | sed "s/$pstack$//g")

eval $cmd
